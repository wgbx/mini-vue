# effect.ts

这个文件是 Vue.js 响应系统的一部分，主要用于处理副作用（effect）的注册和追踪。下面是对文件中主要函数的详细说明：

## `effect(fn, options = {})`

这个函数用于创建一个响应式的副作用。它接受一个函数 `fn` 和一个可选的配置对象 `options`。

- **参数**:
  - `fn`: 将被副作用系统调用的函数。
  - `options`: 一个对象，可以包含多个配置选项，比如 `lazy`。
- **返回值**: 返回一个封装后的副作用函数。
- **行为**:
  - 如果 `options.lazy` 不为真，副作用函数会立即执行。
  - 副作用函数被添加到一个全局栈 `effectStack` 中，以确保正确的嵌套和追踪。

## `createReactiveEffect(fn, options)`

这个内部函数用于创建一个具体的响应式副作用函数。

- **参数**:
  - `fn`: 原始函数，将被副作用系统调用。
  - `options`: 配置选项。
- **返回值**: 返回一个封装的副作用函数。
- **行为**:
  - 副作用函数在调用时会检查是否已经在 `effectStack` 中，以避免重复调用。
  - 在执行 `fn` 前后，会正确地管理 `effectStack` 和 `activeEffect`，确保副作用的上下文管理。

## `Track(target, type, key)`

这个函数用于追踪一个对象的属性，以便在属性被访问时能够注册当前激活的副作用。

- **参数**:
  - `target`: 被追踪的目标对象。
  - `type`: 操作类型（目前未使用，但可用于未来扩展）。
  - `key`: 被追踪的属性键。
- **行为**:
  - 如果当前没有激活的副作用 (`activeEffect`)，则直接返回。
  - 为目标对象的属性创建一个依赖映射和集合，如果当前激活的副作用不在这个集合中，则将其添加进去。

这个文件是 Vue 响应式系统的核心部分，通过这些函数，Vue 能够有效地追踪和响应状态变化，从而实现数据到视图的响应式绑定。
